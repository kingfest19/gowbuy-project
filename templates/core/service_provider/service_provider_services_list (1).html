{% extends "base.html" %}
{% load static i18n %}
{% load notification_tags %} {# Load notification tags for the included sidebar #}
{% load humanize %}

{% block title %}{{ page_title|default:_("My Services") }} - {{ block.super }}{% endblock %}

{% block content %}
<div class="container-fluid my-4">
    <div class="row">
        {% include "core/service_provider/service_provider_dashboard_sidebar_snippet.html" %}

        <main class="col-md-9 ms-sm-auto col-lg-9 px-md-4">
            <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                <h1 class="h2">{{ page_title }}</h1>
                <div class="btn-toolbar mb-2 mb-md-0">
                    <a href="{% url 'core:service_provider_service_create' %}" class="btn btn-sm btn-success">
                        <i class="fas fa-plus-circle"></i> {% trans "Offer New Service" %}
                    </a>
                </div>
            </div>

            {% if messages %}
                {% for message in messages %}
                    <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                {% endfor %}
            {% endif %}

            {% if services %}
            <div class="table-responsive">
                <table class="table table-striped table-hover">
                    <thead>
                        <tr>
                            <th scope="col">{% trans "Title" %}</th>
                            <th scope="col">{% trans "Category" %}</th>
                            <th scope="col">{% trans "Status" %}</th>
                            <th scope="col">{% trans "Packages" %}</th>
                            <th scope="col">{% trans "Actions" %}</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for service in services %}
                        <tr>
                            <td><a href="{% url 'core:service_provider_service_edit' service_slug=service.slug %}">{{ service.title }}</a></td>
                            <td>{{ service.category.name|default:"N/A" }}</td>
                            <td>
                                {% if service.is_active %}
                                    <span class="badge bg-success">{% trans "Active" %}</span>
                                {% else %}
                                    <span class="badge bg-secondary">{% trans "Inactive" %}</span>
                                {% endif %}
                            </td>
                            <td>{{ service.packages.count }}</td>
                            <td>
                                <a href="{% url 'core:service_provider_service_edit' service_slug=service.slug %}" class="btn btn-sm btn-outline-primary me-1" title="{% trans 'Edit' %}"><i class="fas fa-edit"></i></a>
                                <a href="{% url 'core:service_provider_service_delete' service_slug=service.slug %}" class="btn btn-sm btn-outline-danger" title="{% trans 'Delete' %}"><i class="fas fa-trash-alt"></i></a>
                                <a href="{{ service.get_absolute_url }}" class="btn btn-sm btn-outline-info ms-1" title="{% trans 'View Public Page' %}" target="_blank"><i class="fas fa-eye"></i></a>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            {% include "core/includes/pagination.html" %} {# Assuming you have a pagination include #}
            {% else %}
            <div class="alert alert-light text-center" role="alert">
                <p class="lead">{% trans "You haven't offered any services yet." %}</p>
                <a href="{% url 'core:service_provider_service_create' %}" class="btn btn-primary">
                    <i class="fas fa-plus-circle"></i> {% trans "Offer Your First Service" %}
                </a>
            </div>
            {% endif %}

        </main>
    </div>
</div>
{% endblock content %}