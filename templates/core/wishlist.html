{% extends 'core/user_dashboard_base.html' %}
{% load i18n static %}

{% block title %}{{ page_title }}{% endblock %}

{% block dashboard_content %}
<div class="d-flex justify-content-between align-items-center border-bottom pb-2 mb-4">
    <h1 class="h2 mb-0">{% trans "My Wishlist" %}</h1>
</div>

{% if messages %}
    {% for message in messages %}
        <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    {% endfor %}
{% endif %}

{% if wishlist_items %}
<div class="table-responsive">
    <table class="table table-hover align-middle">
        <thead>
            <tr>
                <th scope="col" colspan="2">{% trans "Product" %}</th>
                <th scope="col">{% trans "Price" %}</th>
                <th scope="col">{% trans "Stock Status" %}</th>
                <th scope="col"></th>
            </tr>
        </thead>
        <tbody>
            {% for item in wishlist_items %}
            <tr>
                <td style="width: 100px;">
                    <a href="{{ item.get_absolute_url }}">
                        {% if item.image %}
                            <img src="{{ item.image.image.url }}" alt="{{ item.name }}" class="img-fluid rounded" style="width: 80px; height: 80px; object-fit: cover;">
                        {% else %}
                            <img src="{% static 'assets/img/placeholder.png' %}" alt="{% trans 'No image available' %}" class="img-fluid rounded" style="width: 80px; height: 80px; object-fit: cover;">
                        {% endif %}
                    </a>
                </td>
                <td>
                    <a href="{{ item.get_absolute_url }}" class="text-dark fw-bold text-decoration-none">{{ item.name }}</a>
                    <p class="small text-muted mb-0">{{ item.category.name }}</p>
                </td>
                <td>
                    <span class="fw-bold">GHâ‚µ{{ item.price }}</span>
                </td>
                <td>
                    {% if item.is_in_stock %}
                        <span class="badge bg-success-soft text-success">{% trans "In Stock" %}</span>
                    {% else %}
                        <span class="badge bg-danger-soft text-danger">{% trans "Out of Stock" %}</span>
                    {% endif %}
                </td>
                <td class="text-end">
                    {% if item.is_in_stock %}
                        <a href="{% url 'core:add_to_cart' product_id=item.id %}" class="btn btn-primary btn-sm me-2"><i class="fas fa-cart-plus me-1"></i> {% trans "Add to Cart" %}</a>
                    {% else %}
                        <button class="btn btn-secondary btn-sm me-2" disabled>{% trans "Out of Stock" %}</button>
                    {% endif %}
                    <form action="{% url 'core:remove_from_wishlist' product_id=item.id %}" method="post" class="d-inline">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-outline-danger btn-sm" title="{% trans 'Remove from wishlist' %}"><i class="fas fa-trash-alt"></i></button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% else %}
<div class="text-center py-5">
    <i class="fas fa-heart-broken fa-3x text-muted mb-3"></i>
    <h4>{% trans "Your wishlist is empty." %}</h4>
    <p class="text-muted">{% trans "Looks like you haven't added anything to your wishlist yet. Start exploring and find something you love!" %}</p>
    <a href="{% url 'core:product_list' %}" class="btn btn-primary">{% trans "Start Shopping" %}</a>
</div>
{% endif %}

{% endblock dashboard_content %}

